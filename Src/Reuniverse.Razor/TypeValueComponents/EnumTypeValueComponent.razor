@inherits TypeValueComponentBase<object?>

<select disabled="@IsReadOnly" @onchange="OnChange">
    @if (Type is not null)
    {
        @foreach (var enumValue in Enum.GetValues(Type))
        {
            <option value="@((int)enumValue)" selected="@enumValue.Equals(Value)">@enumValue</option>
        }
    }
</select>

@if (Exception is not null)
{
    <div style="color: var(--color-red);">@Exception.Message</div>
}

@code {
    public Type? Type => Property?.PropertyType ?? Item?.Value?.GetType();

    private async Task OnChange(ChangeEventArgs e)
    {
        if (Value is null) return;

        var enumType = Value.GetType();
        var originalValue = Value;

        try
        {
            Value = Enum.ToObject(enumType, Convert.ToInt32(e.Value));
            Exception = null;
        }
        catch (Exception ex)
        {
            Exception = ex;
        }
    }
}
